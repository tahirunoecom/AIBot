---
version: "3.1"

# List of all intents the assistant should handle.  Be sure to include
# any intent names referenced in your stories, rules, or NLU examples.
intents:
  - greet
  - show_categories
  - search_products
  - search_products_next
  - select_product
  - add_to_cart
  - view_cart
  - get_address
  - checkout
  - pay_now
  - check_payment_status
  - track_order
  - faq
  - goodbye
  - bot_challenge
  - provide_zipcode
  - search_store
  - select_store
  - change_zipcode
  - change_store
  - login
  - provide_user_id
  - register
  - inform
  - provide_password
  - next_store_page
  - previous_store_page
  - previous_product_page

# Entity types used by the NLU.  These names must match the entity
# annotations in your training data and the parameters returned from any
# regex or lookup extraction.
entities:
  - product_category
  - product_name
  - order_id
  - product_title
  - zipcode
  - store_name

# Slots are used to store information about the conversation so it can
# influence future responses.  Custom slot mappings are used here because
# values are set explicitly in the actions rather than extracted from
# user messages.
slots:
  user_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  recent_products:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  selected_product:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  order_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  search_page:
    type: float
    initial_value: 1.0
    influence_conversation: false
    mappings:
      - type: custom
  store_page:
    type: float
    initial_value: 1.0
    influence_conversation: false
    mappings:
      - type: custom
  last_search_string:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  zipcode:
    type: text
    influence_conversation: false
    mappings:
      # Automatically fill the zipcode slot when the user provides a 5‑digit code
      - type: from_entity
        entity: zipcode
  last_zipcode:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  selected_store:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  # Flag to indicate whether the user has been greeted already in the
  # current conversation.  This is used by the custom greet action to
  # avoid repeating the welcome message during multi‑turn flows (e.g.,
  # login) or when misclassifications occur.
  has_been_greeted:
    type: bool
    influence_conversation: false
    initial_value: false
    mappings:
      - type: custom
  # Indicates that the assistant is currently in a store search flow.  If
  # true, numeric inputs are interpreted as store selections instead of
  # product selections.
  store_context:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  # Slots used during the login process.  These track the current step
  # (awaiting phone or password) and store the values until the login
  # process is completed.
  login_step:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  login_phone:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  login_password:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        intent: provide_password
  # Stores returned by the nearest store search.  This slot keeps the list
  # of stores shown to the user so that a subsequent numeric or name
  # input can be mapped back to a specific store.
  stores_list:
    type: list
    influence_conversation: false
    mappings:
      - type: custom

# Response templates used by utter actions.  These are simple text
# responses; if you need more complex logic, define a custom action.
responses:
  utter_greet:
    - text: "Welcome to AnythingInstantly! How can I help you today?"
  utter_faq:
    - text: |
        You can return a product within 7 days by visiting your orders page.
    - text: |
        Delivery is free for orders above ₹1,000.
        For others, a small fee applies.
    - text: |
        Please contact customer support for any help.
  utter_goodbye:
    - text: "Goodbye! If you need anything else, just ask."
  utter_iamabot:
    - text: |
        I am an AI‑powered assistant here to help you shop quickly and easily.
  utter_default:
    - text: "Sorry, I didn't understand that. Could you rephrase?"
  utter_register_link:
    - text: |
        You can create a new account by visiting our sign‑up page:
        https://stage.anythinginstantly.com
  utter_fallback_store_search:
    - text: |
        Sorry, I couldn't find a matching store.
        Please try again or enter a different name.

# List of all custom actions implemented in actions.py.  Make sure every
# action referenced in your rules or stories appears here.
actions:
  - action_show_categories_with_products
  - action_product_llm_search
  - action_search_products
  - action_select_product
  - action_add_to_cart
  - action_view_cart
  - action_checkout
  - action_get_address
  - action_create_stripe_checkout
  - action_check_payment_status
  - action_track_order
  - action_next_product_page
  - action_reset_search_page
  - action_get_nearest_store
  - action_set_selected_store
  - action_show_store_options
  - action_change_zipcode
  - action_custom_fallback
  - action_prompt_login
  - action_login_user
  - action_custom_greet
  - action_change_store
  - action_recall_previous_location
  - validate_zipcode_form
  - action_next_store_page
  - action_previous_store_page
  - action_previous_product_page